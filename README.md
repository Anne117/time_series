# Решение задачи классифкации временных рядов на 2 класса.

Этот репозиторий содержит Jupyter Notebook для обучения и оценки модели машинного обучения на временных рядах. Ноутбук структурирован для покрытия полного процесса, начиная с разведочного анализа данных (EDA) до финальной оценки модели.

------

## Структура репозитория time_series

### **pipeline.ipynb**
   - **Описание**: Файл отвечает за запуск уже обученной модели и генерацию предсказаний к тестовому файлу.

### **submission.csv**
   - **Описание**: Файл содержит уже сгенерированные с помощью _pipeline.ipynb_ предсказания меток классов для тестового датасета test.parquet.

### **test.parquet**
   - **Описание**: Файл содержит тестовые данные для предсказания.

### **requirements.txt**
   - **Описание**: Файл содержит названия необходимых библиотек для запуска модели без обучения из файла _pipeline.ipynb_.

### **train.parquet**
   - **Описание**: Файл содержит тренировочные данные для обучения модели.

### **train.ipynb**
   - **Описание**: Файл отвечает за рассмотрение моделей для решения задачи и эксперименты с поиском наилучшей модели.

### **voting_classifier_model.zip**
   - **Описание**: Зип-архив содержит файл _voting_classifier_model.pkl_ с информацией об обученной модели, ее веса и параметры, а, также, конфигурацию голосования.

-----

## Инструкця по быстрому запуску модели без обучения

### 1. 
Скачайте себе файлы **_train.parquet_**, **_test.parquet_**, **_pipeline.ipynb_**

### 2. 
Скачайте **_voting_classifier_model.zip_** и распакуйте до получения файла **_voting_classifier_model.pkl_**

### 3. 
Положите все файлы в одну и ту же директорию и откройте файл **_pipeline.ipynb_**

### 4. 
Запустите обе ячейки данного файла, при необходимости установите недостающие библиотекии из списка импортов (используйте **_requirements.txt_**)

### 5. 
После успешной работы файла будет сгенерирован **_submission.csv_** в ту же директорию

------

## Описание файла train.ipynb

### 1. **Разведочный анализ данных (EDA)**
   - **Описание**: Этот раздел загружает тренировочный и тестовый наборы данных, выводит начальные примеры данных и исследует форму и типы данных в наборах.
   - **Основные этапы**:
     1. Вывод всех данных для понятия структуры данных.
     2. Проверка на дисбаланс классов.
     3. Форматирование данных в подходящий для работы вид.
     4. Визуализация имеющихся данных.
     5. Оценка данных на основе проведенного анализа.

### 2. **Рассмотрение двух моделей и возможных их вариаций**
   - **Описание**: Мною были рассмотрены модели HistGradientBoostingClassifier и XGBoost с различными улучшениями, а также их ансамбль с добавлением случайного леса. Обе модели принмали однаковые улучшения для сравнения конечного результата. Все улучшения и обе модели с ними вошли в конечное решение. Что было добавлено к стандартным моделям HistGradientBoostingClassifier и XGBoost в ходе улучшения качества на тестовой выборке:
   - Добавление статистических признаков: квартили, вариации, автокоррелляция.
   - Фильтрация данных: скользящее среднее и медианная фильтрация.
   - Балансировка классов: взвешивание классов или добавление синтетических примеров для меньших классов.
   - Отбор признаков на основе значимости.
   - Валидационные техники: TimeSeriesSplit.

### 4. **Выбор модели**
   - **Описание**: HistGradientBoostingClassifier показал себя ненмого лучше, чем XGBoost, поэтому было принятно решение ансамблировать три модели вместе, что еще больше улучшило результат. Также, еще был опробовал метод извлечения признаков с помощью ARIMA, но он не показал хороших результатов в моем случае.

### 5. **Оценка модели**
   - **Описание**: Оценка обученной модели на валидационных и тестовых наборах данных с использованием метрики ROC AUC.


---

